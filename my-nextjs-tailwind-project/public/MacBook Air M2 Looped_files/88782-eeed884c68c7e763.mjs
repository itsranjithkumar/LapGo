"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[88782],{410688:(e,t,a)=>{a.d(t,{Z:()=>i});let i=e=>{switch(e){case"BR":case"MX":case"AR":case"CL":case"CO":return"LatAm";case"US":return"US";case"CA":return"CA";case"GB":return"GB";case"FR":return"FR";case"DE":return"DE";case"AU":return"AU";case"IN":return"IN";default:return"OTHER"}}},288782:(e,t,a)=>{a.d(t,{Z:()=>D});var i=a(667294),s=a(293041),r=a(883119),l=a(488792),n=a(512541),o=a(297728),h=a(730212),d=a(383399),p=a(706680),u=a(74213),c=a(907886),m=a(673687),y=a(830017),S=a(115642),P=a(565671),b=a(785893);function f(e,t,a){var i;return(t="symbol"==typeof(i=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?i:i+"")in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}let g=(e,t)=>typeof e!=typeof t||(Array.isArray(t)?e.length!==t.length||t.some((t,a)=>!Array.isArray(e)||t.type!==e[a].type||t.src!==e[a].src):t!==e),v=e=>e[0].src?[{...e[0],src:e[0].src}]:e,T=e=>"string"==typeof e?e:Array.isArray(e)?v(e):e;class k extends i.PureComponent{constructor(...e){super(...e),f(this,"state",{canPlayVideo:!1,isManifestParsed:!1,playbackState:m.Cy.DEFAULT,videoStartTime:this.props.seekTime||0}),f(this,"errorRetryCount",1),f(this,"firstFragBuffered",!1),f(this,"hasPlaybackStarted",!1),f(this,"hasVideoSessionStarted",!1),f(this,"hasVideoSessionEnded",!1),f(this,"hls",null),f(this,"fragStartupTime",{}),f(this,"lastLevelSwitchKbps",null),f(this,"lastStallTime",null),f(this,"lastPauseTime",null),f(this,"logSessionStartOnNextPlay",!1),f(this,"playerId",""),f(this,"videoSessionId",""),f(this,"videoVisibleTime",null),f(this,"playbackPerformance",{canPlayTime:null,detailedErrors:"",downloadedKiloBytes:0,errorCode:0,errorName:"",errorReason:"",hasFatalError:!1,loadStartTime:null,numberOfStalls:0,numberOfSeeks:0,playbackStartTimestamp:null,segments:[],srcString:"string"==typeof this.props.src?this.props.src:this.props.src[0].src,totalStallDurationMs:0,totalPauseDurationMs:0,userAgent:this.props.userAgent,videoCreatedTime:null,webBrowser:this.props.webBrowser,webBrowserVersion:this.props.webBrowserVersion}),f(this,"initializeHls",()=>{this.destroyHls();let{src:e,hlsConfig:t}=this.props,a=new s.ZP(t),i=T(e);a.loadSource(i),this.videoPlayerRef&&a.attachMedia(this.videoPlayerRef.video),a.on(s.ZP.Events.FRAG_BUFFERED,this.handleHlsFragBuffered),a.on(s.ZP.Events.FRAG_CHANGED,this.handleHlsFragChanged),a.on(s.ZP.Events.FRAG_LOADING,this.handleHlsFragLoading),a.on(s.ZP.Events.FRAG_LOADED,this.handleHlsFragLoaded),a.on(s.ZP.Events.MANIFEST_PARSED,()=>{this.setState({isManifestParsed:!0})}),a.on(s.ZP.Events.LEVEL_SWITCHED,this.handleHlsLevelSwitched),a.on(s.ZP.Events.ERROR,this.handleHlsError),this.hls=a}),f(this,"destroyHls",()=>{let{hls:e}=this;e&&e.destroy()}),f(this,"addSegment",e=>{let{segments:t}=this.playbackPerformance,a=t&&t[t.length-1];if(this.hls&&t.length&&a&&a.uri!==e.url){this.updateWatchDurationForCurrentSegment();let a=this.videoPlayerRef&&this.videoPlayerRef.video,i=this.hls&&this.hls.levels||{},s="number"==typeof e.level?i[e.level]:{},r=this.fragStartupTime[e.url],l=-1;r&&r.startLoadTime&&r.endLoadTime&&(l=r.endLoadTime-r.startLoadTime);let n={indicatedKbps:s.bitrate/m.bR,duration:e.duration,level:e.level,lastStartPlayTime:this.getCurrentVideoTime(),numServerAddressChange:-1,observedKbps:this.hls&&this.hls.bandwidthEstimate/m.bR||-1,playbackStartDate:Date.now(),serverAddress:"",sn:e.sn,sourceWidth:s.width,sourceHeight:s.height,startupTimeMs:l,switchBitrateKbps:this.lastLevelSwitchKbps||-1,uri:e.url,viewportWidth:a&&a.clientWidth||-1,viewportHeight:a&&a.clientHeight||-1,watchedDurationMs:0};t.push(n)}}),f(this,"initializeSegments",e=>{let{contextLogData:t={}}=this.props,{is_closeup_video:a=!1}=t,{segments:i}=this.playbackPerformance;if(!i.length){if(!this.hls||!this.videoPlayerRef||!this.videoPlayerRef.video||!e){(0,c.tE)("initializeSegmentsFailed",!0,a);return}if(!i.length&&"number"==typeof e.level){let t=this.videoPlayerRef&&this.videoPlayerRef.video,{levels:a}=this.hls,s="number"==typeof e.level?a[e.level]:{},r=this.fragStartupTime[e.url],l=-1;r&&r.startLoadTime&&r.endLoadTime&&(l=r.endLoadTime-r.startLoadTime),this.lastLevelSwitchKbps=this.hls.bandwidthEstimate/m.bR;let n={indicatedKbps:s.bitrate/m.bR,duration:e.duration,level:e.level,lastStartPlayTime:null,numServerAddressChange:-1,observedKbps:this.hls.bandwidthEstimate/m.bR||-1,playbackStartDate:null,serverAddress:"",sn:e.sn,sourceWidth:s.width,sourceHeight:s.height,startupTimeMs:l,switchBitrateKbps:this.lastLevelSwitchKbps||-1,uri:e.url,viewportWidth:t.clientWidth,viewportHeight:t.clientHeight,watchedDurationMs:0};i.push(n)}}}),f(this,"getCurrentVideoTime",()=>this.videoPlayerRef&&this.videoPlayerRef.video?this.videoPlayerRef.video.currentTime*m.gJ:null),f(this,"handleCanPlayVideo",e=>{let{contextLogData:t={},onReady:a,playing:i}=this.props,{is_closeup_video:s=!1}=t,{canPlayVideo:r}=this.state;(0,c.tE)("handleCanPlayVideo",!0,s,{firstCanPlayEvent:!r,playing:i}),this.playbackPerformance.hasFatalError=!1,r||(this.playbackPerformance.canPlayTime=new Date),this.setState({canPlayVideo:!0}),a&&a(e)}),f(this,"handleEnded",e=>{let{loop:t,onEnded:a}=this.props,{segments:i}=this.playbackPerformance,s=i&&i[i.length-1];t&&this.videoPlayerRef&&this.videoPlayerRef.video?(this.updateWatchDurationForCurrentSegment(),s&&(s.lastStartPlayTime=0),this.fragStartupTime={}):t||this.logPlaybackPerformance(m.$f,{initiator:"videoEnded",loop:t}),this.setState({playbackState:m.Cy.ENDED}),a&&a(e)}),f(this,"handleHlsError",(e,t)=>{let{contextLogData:a={}}=this.props,{is_closeup_video:i=!1}=a;if(this.playbackPerformance.detailedErrors=t.err?.message||"unknown",t.fatal){this.playbackPerformance.hasFatalError=!0,this.playbackPerformance.errorName=t.type,this.playbackPerformance.errorReason=t.details,this.playbackPerformance.errorCode=t.response&&t.response.code?t.response.code:0;let e={errorName:t.type,errorReason:t.details,errorRetryCount:this.errorRetryCount,errorMessage:t.err?.message?.slice(0,50)||"unknown",errorResponse:t.response?.text?.slice(0,50)||"unknown",playbackState:this.state.playbackState};if((0,c.tE)("fatalError",!0,i,e),this.errorRetryCount>0)switch(this.errorRetryCount-=1,t.type){case s.ZP.ErrorTypes.NETWORK_ERROR:if(t.details===s.ZP.ErrorDetails.MANIFEST_LOAD_ERROR||t.details===s.ZP.ErrorDetails.MANIFEST_LOAD_TIMEOUT||t.details===s.ZP.ErrorDetails.MANIFEST_LOAD_PARSING_ERROR){let e=T(this.props.src);this.hls?.loadSource(e)}else this.hls?.startLoad();break;case s.ZP.ErrorTypes.MEDIA_ERROR:this.hls?.recoverMediaError()}}this.updateWatchDurationForCurrentSegment(),this.setState({playbackState:m.Cy.FAILED})}),f(this,"handleHlsFragBuffered",(e,t)=>{this.firstFragBuffered||(this.initializeSegments(t.frag),this.firstFragBuffered=!0)}),f(this,"handleHlsFragChanged",(e,t)=>{this.addSegment(t.frag)}),f(this,"handleHlsFragLoading",(e,t)=>{let a=t.frag?.url;a&&!this.fragStartupTime[a]&&(this.fragStartupTime[a]={startLoadTime:new Date})}),f(this,"handleHlsFragLoaded",(e,t)=>{t.frag&&t.frag.loaded&&(this.playbackPerformance.downloadedKiloBytes+=t.frag.loaded/m.Fm);let a=t.frag?.url;a&&this.fragStartupTime[a]&&this.fragStartupTime[a].startLoadTime&&(this.fragStartupTime[a].endLoadTime=new Date)}),f(this,"handleHlsLevelSwitched",()=>{this.hls&&this.hls.bandwidthEstimate&&(this.lastLevelSwitchKbps=this.hls.bandwidthEstimate/m.bR)}),f(this,"handleLoadedMetadata",()=>{this.setState({playbackState:m.Cy.LOADED_METADATA})}),f(this,"handleLoadStart",()=>{this.playbackPerformance.loadStartTime=new Date,this.setState({playbackState:m.Cy.LOAD_START})}),f(this,"handleLoadedData",()=>{this.setState({playbackState:m.Cy.LOADED_DATA})}),f(this,"handlePlaying",e=>{this.playbackPerformance.hasFatalError=!1,this.setPlaybackStartTime(),this.setLastSegmentStartPlayTime(),this.setLastSegmentPlaybackStartDate(),this.updateStallDuration(),this.updatePauseDuration(),this.setState({playbackState:m.Cy.PLAYING}),this.props.clearSeekTime&&this.props.clearSeekTime(),this.props.onPlaying&&this.props.onPlaying(e)}),f(this,"handleUserPause",e=>{let{onControlsPause:t}=this.props;this.lastPauseTime=new Date,t&&t(e)}),f(this,"handleVideoPause",()=>{this.state.playbackState===m.Cy.STALLING||this.state.playbackState===m.Cy.SEEKING||(this.updateWatchDurationForCurrentSegment(),this.lastPauseTime||this.updateStallDuration()),this.setState({playbackState:m.Cy.PAUSED})}),f(this,"handleSeeking",()=>{this.playbackPerformance.numberOfSeeks+=1;let{segments:e}=this.playbackPerformance,t=e&&e[e.length-1];t&&(t.lastStartPlayTime=null),this.state.playbackState!==m.Cy.ENDED&&this.setState({playbackState:m.Cy.SEEKING})}),f(this,"handleStalled",()=>{null===this.lastStallTime&&this.state.playbackState!==m.Cy.ENDED&&(this.lastStallTime=new Date,this.playbackPerformance.numberOfStalls+=1),this.setState({playbackState:m.Cy.STALLING})}),f(this,"handleTimeUpdate",e=>{let{onTimeChange:t}=this.props;t&&t(e),this.state.playbackState===m.Cy.PLAYING&&(this.updateWatchDurationForCurrentSegment(),this.setLastSegmentStartPlayTime())}),f(this,"resetPlaybackMetrics",()=>{this.hasPlaybackStarted=!1,this.hasVideoSessionStarted=!1,this.hasVideoSessionEnded=!0,this.lastLevelSwitchKbps=null,this.lastStallTime=null,this.lastPauseTime=null,this.videoSessionId="",this.videoVisibleTime=null,this.logSessionStartOnNextPlay=!1;let e={...this.playbackPerformance.segments[this.playbackPerformance.segments.length-1],lastStartPlayTime:null,playbackStartDate:null,switchBitrateKbps:-1,watchedDurationMs:0};this.playbackPerformance.detailedErrors="",this.playbackPerformance.downloadedKiloBytes=0,this.playbackPerformance.errorCode=0,this.playbackPerformance.errorName="",this.playbackPerformance.errorReason="",this.playbackPerformance.hasFatalError=!1,this.playbackPerformance.numberOfStalls=0,this.playbackPerformance.numberOfSeeks=0,this.playbackPerformance.playbackStartTimestamp=null,this.playbackPerformance.totalStallDurationMs=0,this.playbackPerformance.segments=[e]}),f(this,"setLastSegmentStartPlayTime",()=>{let{segments:e}=this.playbackPerformance,t=e&&e[e.length-1];t&&null===t.lastStartPlayTime&&(t.lastStartPlayTime=this.getCurrentVideoTime())}),f(this,"setLastSegmentPlaybackStartDate",()=>{let{segments:e}=this.playbackPerformance,t=e&&e[e.length-1];t&&null===t.playbackStartDate&&(t.playbackStartDate=Date.now())}),f(this,"setPlaybackStartTime",()=>{this.hasPlaybackStarted||(this.playbackPerformance.playbackStartTimestamp=Date.now(),this.hasPlaybackStarted=!0)}),f(this,"setVideoPlayerRef",e=>{let{setVideoRef:t}=this.props;if(e&&(t&&t(e),this.videoPlayerRef=e,this.videoPlayerRef.video)){let e=this.videoPlayerRef.video;e.addEventListener("loadedmetadata",this.handleLoadedMetadata),e.addEventListener("loadeddata",this.handleLoadedData),e.addEventListener("pause",this.handleVideoPause),e.readyState>=3&&(this.setState({canPlayVideo:!0}),this.playbackPerformance.canPlayTime=new Date)}}),f(this,"updateStallDuration",()=>{null!==this.lastStallTime&&(this.playbackPerformance.totalStallDurationMs+=Date.now()-this.lastStallTime.getTime(),this.lastStallTime=null)}),f(this,"updatePauseDuration",()=>{if(null!==this.lastPauseTime){let{lastPauseTime:e}=this;this.playbackPerformance.totalPauseDurationMs+=Date.now()-e.getTime(),this.lastPauseTime=null}}),f(this,"updateWatchDurationForCurrentSegment",()=>{let{segments:e}=this.playbackPerformance,t=e&&e[e.length-1],a=t?t.lastStartPlayTime:null,i=this.getCurrentVideoTime();if(t&&null!==a&&"number"==typeof i&&"number"==typeof a){let e=i-a;e>0&&(t.watchedDurationMs+=e,t.lastStartPlayTime=null)}}),f(this,"logPlaybackPerformance",(e,t)=>{let{contextLogData:a={},userId:i,isAutoPlay:s,logContextEvent:r,preload:l,userAgent:n,webBrowser:o,webBrowserVersion:h}=this.props,{is_closeup_video:d=!1}=a,{canPlayTime:y,detailedErrors:S,downloadedKiloBytes:P,errorCode:b,errorName:f,errorReason:g,hasFatalError:v,playbackStartTimestamp:T,totalPauseDurationMs:k,totalStallDurationMs:D,segments:E,srcString:R,loadStartTime:w,numberOfStalls:C,numberOfSeeks:L}=this.playbackPerformance,A=this.videoPlayerRef&&this.videoPlayerRef.video,V=e===m.DR,_=V&&!this.hasVideoSessionStarted,H=!V&&!this.hasVideoSessionEnded&&this.hasVideoSessionStarted;if(this.hls&&A&&(_||H)){let _=-1;y&&w&&(_=y>w?y.getTime()-w.getTime():0);let H=-1;y&&this.videoVisibleTime&&(H=y>this.videoVisibleTime?y.getTime()-this.videoVisibleTime.getTime():0),V&&(this.videoSessionId=(0,u.Z)(i),this.playerId=this.playerId||(0,p.Z)());let F={autoplaying:s,averageVideoKbps:-1,detailedErrors:S,downloadedKiloBytes:P,isCellular:!1,errorCode:b,errorName:f,errorReason:g,fatalError:v,nativeVideoDurationMs:A.duration*m.gJ||-1,numberOfStalls:C,numberOfSeeks:L,overallPausedDurationMs:k,overallBufferDurationMs:D,overallWatchedDurationMs:-1,rebufferRate:-1,playbackSessionId:this.videoSessionId,playbackStartTimestamp:T||-1,segments:[],sessionMark:e,screenPixelScale:window?.devicePixelRatio?window.devicePixelRatio:-1,startupPlayerWidth:A.clientWidth,startupPlayerHeight:A.clientHeight,startupTimeMs:_,startupLatencyMs:H,startupVariantKbps:-1,startupVariantWatchedDurationMs:-1,startupVariantWidth:A.videoWidth,startupVariantHeight:A.videoHeight,videoUrl:R,wasVideoPreloaded:"auto"===l};if(!V&&E.length){let{levels:e}=this.hls,t=E[0];this.updateWatchDurationForCurrentSegment(),this.updateStallDuration();let a=E.reduce((t,a)=>a&&"number"==typeof a.level&&e&&e.length>0?t+(e[a.level]||{}).bitrate*(a.watchedDurationMs||0)/m.gJ:t,0),i=E.reduce((e,t)=>e+(t.watchedDurationMs||0),0),s=null,r=0,l=0;do r+=E[l].watchedDurationMs,s=s||E[l].level,l+=1;while(l<E.length&&E[l].level===s)F.startupVariantKbps=t.indicatedKbps,F.startupVariantWatchedDurationMs=r,F.startupVariantWidth=t.sourceWidth,F.startupVariantHeight=t.sourceHeight,F.startupPlayerWidth=t.viewportWidth,F.startupPlayerHeight=t.viewportHeight,F.overallWatchedDurationMs=i,i>0?(F.averageVideoKbps=a/(i/m.gJ),F.rebufferRate=this.playbackPerformance.totalStallDurationMs/i):0===i&&(F.averageVideoKbps=-1,F.rebufferRate=-1,F.errorName="invalid_watch_duration"),F.segments=E}else F.errorName="invalid_watch_duration";(0,c.ZP)(F,!0,d,{playbackState:this.state.playbackState,...t});let{clientTrackingParams:M,component:x,durationNs:I,element:O,objectId:N,pairId:W,viewData:Z,view:B,viewParameter:K,...$}=a;r({aux_data:{...$,is_closeup_video:d,playback_session_id:this.videoSessionId,user_agent:n,web_browser:o,web_browser_version:h},clientTrackingParams:M,component:x,duration_ns:I,element:O,event_data:{videoPerformanceData:F},event_type:3606,object_id_str:N,pair_id:W,view_data:Z,view_parameter:K,view_type:B}),V?(this.hasVideoSessionStarted=!0,this.hasVideoSessionEnded=!1):this.resetPlaybackMetrics(),(0,c.tE)(V?"sessionStart":"sessionEnd",!0,d,{playbackState:this.state.playbackState,...t})}})}componentDidMount(){let{contextLogData:e={},playing:t}=this.props,{is_closeup_video:a=!1}=e;this.playbackPerformance.videoCreatedTime=new Date,this.initializeHls(),(0,c.tE)("videoMounted",!0,a),t&&(this.videoVisibleTime=new Date,this.logPlaybackPerformance(m.DR,{initiator:"mount"}))}componentDidUpdate(e){let{loop:t,playing:a,src:i,visible:s,appInFocus:r,seekTime:l,captionsEnabled:n}=this.props,o=this.videoPlayerRef?.video?.textTracks[0];o&&(n?o.mode="showing":o.mode="disabled",o.addEventListener("cuechange",()=>{let e=o.activeCues&&o.activeCues.length>0&&o.activeCues[0];e&&e.line&&(e.line=-6,e.size=88)})),l&&l!==e.seekTime&&this.setState({videoStartTime:l}),g(e.src,i)&&this.initializeHls(),e.appInFocus&&!r&&(this.logPlaybackPerformance(m.$f,{initiator:"update",loop:t}),this.logSessionStartOnNextPlay=!0),e.visible&&!1===s&&(this.logSessionStartOnNextPlay=!1,this.updatePauseDuration(),this.logPlaybackPerformance(m.$f,{initiator:"update",loop:t})),!1===e.visible&&!0===s&&(this.videoVisibleTime=this.videoVisibleTime||new Date,a?(this.setPlaybackStartTime(),this.setLastSegmentStartPlayTime(),this.setLastSegmentPlaybackStartDate(),this.logPlaybackPerformance(m.DR,{initiator:"update"})):this.logSessionStartOnNextPlay=!0),a&&r&&this.logSessionStartOnNextPlay&&(this.setPlaybackStartTime(),this.setLastSegmentStartPlayTime(),this.setLastSegmentPlaybackStartDate(),this.logPlaybackPerformance(m.DR,{initiator:"update"}),this.logSessionStartOnNextPlay=!1)}componentWillUnmount(){let{loop:e}=this.props;this.updatePauseDuration(),this.logPlaybackPerformance(m.$f,{initiator:"unmount",loop:e}),this.destroyHls()}render(){let{aspectRatio:e,backgroundColor:t,captions:a,closeupWithinMasonryEnabled:i,controls:s,loop:l,loopOverride:o,maxHeight:h,maxWidth:d,fiftyPercentHeight:p,objectFit:u,onDurationChange:c,onFullscreenChange:m,onLoadedChange:y,onControlsPlay:S,onPlayheadDown:f,onPlayheadUp:g,onSeek:v,onVolumeChange:k,peekCloseupEnabled:D,playbackRate:E,playing:R,playsInline:w,poster:C,preload:L,src:A,styleOverrides:V,userAgent:_,viewportSize:H,volume:F,webBrowser:M,webBrowserVersion:x}=this.props,{canPlayVideo:I,isManifestParsed:O,videoStartTime:N}=this.state,W=T(A),Z=i?h:void 0;return D&&(Z="sm"===H?p:h),(0,b.jsxs)(r.xu,{alignItems:i?"center":void 0,display:i?"flex":void 0,height:i?"inherit":void 0,maxHeight:Z,maxWidth:d,children:[(0,b.jsx)(n.Z,{unsafeCSS:P.P+V}),(0,b.jsx)(r.nk,{ref:this.setVideoPlayerRef,aspectRatio:e,backgroundColor:t,captions:a,controls:s,loop:void 0===o?l:o,objectFit:u,onControlsPause:this.handleUserPause,onControlsPlay:S,onDurationChange:c,onEnded:this.handleEnded,onFullscreenChange:m,onLoadedChange:y,onLoadStart:this.handleLoadStart,onPlay:()=>{},onPlayError:()=>{},onPlayheadDown:f,onPlayheadUp:g,onPlaying:this.handlePlaying,onReady:this.handleCanPlayVideo,onSeek:v,onSeeking:this.handleSeeking,onStalled:this.handleStalled,onTimeChange:this.handleTimeUpdate,onVolumeChange:k,onWaiting:this.handleStalled,playbackRate:E,playing:O&&I&&R,playsInline:w,poster:C,preload:L,src:W,startTime:N,userAgent:_,volume:F,webBrowser:M,webBrowserVersion:x})]})}}let D=(0,i.memo)(function(e){let{country:t,isAuthenticated:a,isBot:i,isSocialBot:s,unauthId:r,userAgent:n}=(0,h.B)(),p=(0,l.Z)(),u=(0,d.Z)(),{closeupWithinMasonryEnabled:m,peekCloseupEnabled:P,viewportSize:f}=(0,S.x4)(),{browserName:g,browserVersion:v,isMobile:T,raw:D}=n,{contextLogData:E={}}=e,{is_closeup_video:R=!1,view:w,viewParameter:C}=E,{checkExperiment:L}=(0,o.F)(),{appUI:A}=(0,y.I)(),V=L("web_video_fail_to_start_fix").anyEnabled?A.appInFocus:e.appInFocus;return(0,c.r$)({browserName:g,browserVersion:v,country:t,isAuthenticated:a,isBot:i,is_closeup_video:R,isMobile:T,isSocialBot:s,view:w,viewParameter:C}),(0,b.jsx)(k,{...e,appInFocus:V,closeupWithinMasonryEnabled:m,logContextEvent:p,peekCloseupEnabled:P,userAgent:D,userId:u.id||r,viewportSize:f,webBrowser:g,webBrowserVersion:v})})},706680:(e,t,a)=>{a.d(t,{Z:()=>s});var i=a(172045);function s(){return(0,i.Z)()}},74213:(e,t,a)=>{a.d(t,{Z:()=>s});var i=a(172045);function s(e){return e+"-"+(0,i.Z)()}},907886:(e,t,a)=>{a.d(t,{ZP:()=>u,r$:()=>d,tE:()=>p});var i=a(410688),s=a(673687),r=a(415787);let l=["isCellular","videoUrl","sessionMark"],n={},o="",h=e=>e<0?"negative":0===e?"zero":e<200?"xs":e<400?"s":e<600?"m":e<800?"l":e<1e3?"xl":e<1200?"xxl":"over1200",d=e=>{let{browserName:t,browserVersion:a,country:s,isAuthenticated:r,isBot:l,isMobile:h,isSocialBot:d,view:p="unknown",viewParameter:u="unknown"}=e;o=d&&"socialBot"||l&&"bot"||"nonbot";let c=(0,i.Z)(s);n={browserName:t,browserVersion:a?.split(".")[0]||"0",isAuthenticated:r,isMobile:h,region:c,view:p,viewParameter:u}};function p(e,t,a,i={}){let s={...i,...n},l=`web.video.${t?"hls":"nonHls"}.${o}.${a?"closeup":"nonCloseup"}.${e}`;"nonbot"===o&&(0,r.nP)(l,{sampleRate:1,tags:s})}function u(e,t,a,i={}){let d=a?"closeup":"nonCloseup",p=t?"hls":"nonHls",c=e.sessionMark===s.DR?"sessionStart":"sessionEnd",m={...i,...n};if("nonbot"===o&&(Object.entries(e).forEach(([t,a])=>{let i=`web.video.${p}.${o}.${d}.${c}.${t}`,s=parseInt(a,10),n="number"==typeof s?s:-1;if(!l.includes(t)){if(t.includes("fatalError")&&!0===a){let{errorCode:t,errorName:a,errorReason:s}=e;(0,r.nP)(i,{sampleRate:1,tags:{errorCode:t,errorName:a,errorReason:s,...m}})}else if(t.includes("Width")||t.includes("Height")){let e=h(n);(0,r.nP)(i,{sampleRate:1,tags:{dimensionBucket:e,...m}})}else if("numberOfStalls"===t){let e=a;n>1e3?e="over1000":n>10?e="over10":n<0&&(e="negative"),(0,r.nP)(i,{sampleRate:1,tags:{numberOfStalls:e,...m}})}else"screenPixelScale"===t?(0,r.nP)(i,{sampleRate:1,tags:{screenPixelScale:a||-1,...m}}):n>=0?(0===n&&(0,r.nP)(`${i}.zero`,{sampleRate:1,tags:m}),(0,r.LY)(i,n,{sampleRate:1})):n<0&&(0,r.nP)(`${i}.negative`,{sampleRate:1,tags:m})}}),e.sessionMark!==s.DR)){let{rebufferRate:t,screenPixelScale:a,startupLatencyMs:i,startupVariantWidth:s,startupPlayerWidth:l}=e,n=`web.video.${p}.${o}.${d}.${c}`;"number"==typeof s&&"number"==typeof l&&"number"==typeof a&&(0,r.nP)(`${n}.upscaled.${1.5*s>a*l?"good":"bad"}`,{sampleRate:1,tags:m}),"number"==typeof i&&(0,r.nP)(`${n}.startupLatency.${i<500?"good":"bad"}`,{sampleRate:1,tags:m}),"number"==typeof t&&(0,r.nP)(`${n}.rebufferRate.${t<.01?"good":"bad"}`,{sampleRate:1,tags:m})}}},565671:(e,t,a)=>{a.d(t,{P:()=>S,Z:()=>b});var i=a(667294),s=a(293041),r=a(883119),l=a(118755),n=a(144326),o=a(512541),h=a(730212),d=a(410150),p=a(644797),u=a(383399),c=a(830017),m=a(785893);function y(e,t,a){var i;return(t="symbol"==typeof(i=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?i:i+"")in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}let S=`
  video::cue {
    color: white;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen-Sans, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', Ubuntu, Cantarell, 'Fira Sans', 'Droid Sans', 'Helvetica Neue', Helvetica, 'ヒラギノ角ゴ Pro W3', 'メイリオ', Meiryo, 'ＭＳ Ｐゴシック', Arial, sans-serif;
    font-weight: 450;
    font-size: 18px;
  }
`;class P extends i.PureComponent{constructor(...e){super(...e),y(this,"state",{videoStartTime:this.props.initialVideoStartTime,started:!1}),y(this,"setVideoPlayerRef",e=>{let{setVideoRef:t,handlePlay:a,autoplay:i=!0}=this.props;this.videoPlayerRef=e,e&&t&&t(e.video),this.videoPlayerRef&&this.videoPlayerRef.video&&a&&i&&this.videoPlayerRef.video.addEventListener("canplay",()=>{a({userTriggeredPlay:!1})})}),y(this,"hls",null),y(this,"initializeHls",()=>{this.destroyHls();let{src:e}=this.props,t=new s.ZP;s.ZP.isSupported()&&!(0,l.G6)(this.props.requestContext.userAgent.browserName)&&(t.loadSource(e),this.videoPlayerRef&&t.attachMedia(this.videoPlayerRef.video)),this.hls=t}),y(this,"destroyHls",()=>{let{hls:e}=this;e&&e.destroy()}),y(this,"onPlay",({event:e})=>{let{handlePlay:t}=this.props;e.stopPropagation(),t&&t({userTriggeredPlay:!0})}),y(this,"onPause",({event:e})=>{let{handlePause:t}=this.props;e.stopPropagation(),t&&t()}),y(this,"handleVolumeChange",({event:e,volume:t})=>{let{onVolumeChange:a}=this.props;e.stopPropagation(),a&&a({volume:t})}),y(this,"handleOnReady",e=>{this.props.onReady&&this.props.onReady(e)}),y(this,"handleEnded",()=>{let{onEnded:e,resetCurrentTime:t}=this.props;e&&e(),t()}),y(this,"handlePlaying",()=>{let{clearSeekTime:e,setVideoPlayed:t}=this.props;e&&e(),!this.state.started&&(this.setState({started:!0}),t&&t())})}componentDidMount(){this.initializeHls()}componentWillUnmount(){this.destroyHls()}componentDidUpdate(e){let{playing:t,src:a,seekTime:i,captionsEnabled:r,isDesktop:l,isTablet:n,requestContext:o,isVideoPin:h}=this.props,{isAuthenticated:d}=o;i&&i!==e.seekTime&&this.setState({videoStartTime:i});let p=this.videoPlayerRef?.video?.textTracks[0];p&&(r?p.mode="showing":p.mode="disabled",p.addEventListener("cuechange",()=>{let e=p.activeCues&&p.activeCues.length>0&&p.activeCues[0];if(e&&e.line&&e.size){if(l)e.line=-6,e.size=88;else{if(e.size=70,h){e.line=-5;return}d?e.line=-8:(e.line=-10,n&&(e.line=-15))}}})),e.src!==a&&(this.initializeHls(),this.hls&&this.hls.on(s.ZP.Events.MANIFEST_PARSED,()=>{void 0!==t&&t&&this.videoPlayerRef&&this.videoPlayerRef.play()}))}render(){let{aspectRatio:e,controls:t,loop:a=!1,poster:i,src:s,onTimeChange:l,playing:n,volume:h,captions:d}=this.props;return(0,m.jsxs)(r.xu,{width:"100%",children:[(0,m.jsx)(o.Z,{unsafeCSS:S}),(0,m.jsx)(r.nk,{ref:this.setVideoPlayerRef,aspectRatio:e,autoplay:n,captions:d,controls:t,crossOrigin:"anonymous",dataTestId:"duplo-hls-video",loop:a,onControlsPause:this.onPause,onControlsPlay:this.onPlay,onEnded:this.handleEnded,onPlay:()=>{},onPlayError:()=>{},onPlaying:this.handlePlaying,onReady:this.handleOnReady,onTimeChange:l,onVolumeChange:this.handleVolumeChange,playing:n,playsInline:!0,poster:i,src:s,startTime:this.state.videoStartTime||void 0,volume:h})]})}}function b(e){let{clearSeekTime:t,pinId:a="",seekTime:i}=e,{setVideoPlayed:s}=(0,p.r)(),r=(0,n.ZP)(),l=(0,h.B)(),o=(0,d.HG)(),y=(0,d.Wb)(),{initialVideoStartTime:S,resetCurrentTime:b}=function(e){let{isAuth:t}=(0,u.Z)(),a=(0,d.HG)(),{appUI:i,setCurrentVideo:s}=(0,c.I)(),r=!t&&a,l=0;if(r){let{videosAutoplaying:t}=i,{organicVideosAutoplaying:a}=t,s=a[e];l=s?.currentTime||0}return{initialVideoStartTime:l,resetCurrentTime:()=>{r&&s({pinId:e,currentTime:0,isPromoted:!1})}}}(a);return(0,m.jsx)(P,{...e,clearSeekTime:()=>{t&&t(a)},i18n:r,initialVideoStartTime:S,isDesktop:o,isTablet:y,requestContext:l,resetCurrentTime:b,seekTime:i,setVideoPlayed:()=>{a&&s(a)}})}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/88782-eeed884c68c7e763.mjs.map